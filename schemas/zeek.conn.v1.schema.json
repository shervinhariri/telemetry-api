{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Zeek Connection Log v1",
  "description": "Schema for Zeek connection log data",
  "type": "object",
  "required": ["collector_id", "format", "records"],
  "properties": {
    "collector_id": {
      "type": "string",
      "description": "Identifier for the data collector"
    },
    "format": {
      "type": "string",
      "enum": ["zeek.conn.v1"],
      "description": "Data format version"
    },
    "records": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["ts", "id_orig_h", "id_orig_p", "id_resp_h", "id_resp_p", "proto"],
        "properties": {
          "ts": {
            "type": "number",
            "description": "Timestamp in Unix epoch seconds"
          },
          "id_orig_h": {
            "type": "string",
            "format": "ipv4",
            "description": "Originator host IP address"
          },
          "id_orig_p": {
            "type": "integer",
            "minimum": 0,
            "maximum": 65535,
            "description": "Originator port number"
          },
          "id_resp_h": {
            "type": "string",
            "format": "ipv4",
            "description": "Responder host IP address"
          },
          "id_resp_p": {
            "type": "integer",
            "minimum": 0,
            "maximum": 65535,
            "description": "Responder port number"
          },
          "proto": {
            "type": "string",
            "enum": ["tcp", "udp", "icmp"],
            "description": "Protocol"
          },
          "service": {
            "type": "string",
            "description": "Detected service"
          },
          "duration": {
            "type": "number",
            "description": "Connection duration in seconds"
          },
          "orig_bytes": {
            "type": "integer",
            "minimum": 0,
            "description": "Bytes sent by originator"
          },
          "resp_bytes": {
            "type": "integer",
            "minimum": 0,
            "description": "Bytes sent by responder"
          }
        }
      }
    }
  }
}
